// DOM Elements
const chatbotButton = document.getElementById('chatbot-button');
const chatbotWindow = document.getElementById('chatbot-window');
const chatbotClose = document.getElementById('chatbot-close');
const chatbotInput = document.getElementById('chatbot-input');
const chatbotSend = document.getElementById('chatbot-send');
const chatbotMessages = document.getElementById('chatbot-messages');

 
// سوال جوابا با زبان فارسی دری نوشته شده
const knowledgeBase = [
  { q: "احراز هویت دو عاملی چیست؟", a: "احراز هویت دو عاملی (2FA) یک لایه امنیتی اضافی است که علاوه بر رمز عبور، نیاز به یک کد یک‌بارمصرف (مثلاً از طریق پیامک یا اپلیکیشن) دارد تا وارد حساب شوید." },
  { q: "چطور 2FA را در فیسبوک فعال کنم؟", a: "در فیسبوک، به 'تنظیمات و حریم خصوصی' > 'امنیت و ورود' بروید. گزینه 'احراز هویت دو مرحله‌ای' را انتخاب و روش مورد نظر (مثل پیامک یا اپلیکیشن احراز هویت) را فعال کنید." },
  { q: "چطور 2FA را در اینستاگرام فعال کنم؟", a: "در اینستاگرام، به 'پروفایل' > 'منو (سه خط)' > 'حساب' > 'امنیت' > 'احراز هویت دو مرحله‌ای' بروید و روش را انتخاب کنید." },
  { q: "چطور 2FA را در تلگرام فعال کنم؟", a: "در تلگرام، به 'تنظیمات' > 'حریم خصوصی و امنیت' > 'رمز عبور دو مرحله‌ای' بروید و یک رمز قوی تنظیم کنید." },
  { q: "چطور 2FA را در واتساپ فعال کنم؟", a: "در واتساپ، به 'تنظیمات' > 'حساب' > 'احراز هویت دو مرحله‌ای' بروید و یک رمز ۶ رقمی تنظیم کنید." },
  { q: "رمز عبور قوی چه ویژگی‌هایی دارد؟", a: "رمز عبور قوی باید حداقل ۱۲ کاراکتر داشته باشد، ترکیبی از حروف بزرگ و کوچک، اعداد و نمادها باشد، و برای هر حساب متفاوت باشد." },
  { q: "چطور رمز عبور قوی بسازم؟", a: "از جمله‌ای معنی‌دار استفاده کنید و حروف را با اعداد و نمادها جایگزین کنید. مثال: 'من_در_کابل_زندگی_می‌کنم!' → 'Mn_Dr_Kbl_Zndgy_Myknm!2025'" },
  { q: "آیا می‌توانم از یک رمز عبور برای همه حساب‌ها استفاده کنم؟", a: "خیر! اگر یک حساب هک شود، همه حساب‌های شما در خطر خواهند بود. برای هر حساب یک رمز عبور منحصربه‌فرد بسازید." },
  { q: "مدیر رمز عبور چیست؟", a: "یک اپلیکیشن که رمزهای عبور شما را به صورت رمزنگاری‌شده ذخیره می‌کند. مثال: Bitwarden (رایگان و متن‌باز)." },
  { q: "فیشینگ چیست؟", a: "فیشینگ نوعی کلاهبرداری آنلاین است که طرف مقابل سعی می‌کند با جعل هویت، اطلاعات حساس شما (مثل رمز عبور) را دزدیده یا بدافزار نصب کند." },
  { q: "چطور پیام فیشینگ را تشخیص بدم؟", a: "به این نکات توجه کنید: لینک‌های عجیب، ایمیل‌هایی با آدرس‌های مشکوک، درخواست فوری برای اطلاعات شخصی، اشتباهات املایی زیاد، و فشار روانی (مثل 'حساب شما بسته می‌شود!')." },
  { q: "اگر روی لینک فیشینگ کلیک کردم چه کنم؟", a: "فوراً دستگاه را اسکن کنید، رمز عبور حساب‌های خود را عوض کنید، و اگر اطلاعات مالی داده‌اید، با بانک تماس بگیرید." },
  { q: "چطور تنظیمات حریم خصوصی فیسبوک را تنظیم کنم؟", a: "به 'تنظیمات و حریم خصوصی' > 'حریم خصوصی' بروید. مشخص کنید چه کسانی می‌توانند پست‌ها، دوستان و اطلاعات شما را ببینند." },
  { q: "چطور از ناشناسان در فیسبوک جلوگیری کنم؟", a: "در تنظیمات حریم خصوصی، گزینه 'چه کسانی می‌توانند شما را اضافه کنند؟' را روی 'دوستان دوستان' یا 'دوستان' تنظیم کنید." },
  { q: "چطور پیام‌های ناشناس در اینستاگرام را مسدود کنم؟", a: "در تنظیمات > حریم خصوصی > پیام‌ها، گزینه 'دریافت پیام از افرادی که دنبال نمی‌کنید' را خاموش کنید." },
  { q: "چطور حساب تلگرام را خصوصی کنم؟", a: "به تنظیمات > حریم خصوصی و امنیت بروید. برای 'شماره تلفن'، 'آخرین دیدن' و 'پروفایل' تنظیمات را روی 'تماس‌ها من' یا 'هیچ‌کس' قرار دهید." },
  { q: "چطور از اشتراک‌گذاری موقعیت مکانی در شبکه‌های اجتماعی جلوگیری کنم؟", a: "در تنظیمات اپلیکیشن‌ها، دسترسی موقعیت مکانی را غیرفعال کنید. همچنین در پست‌ها، موقعیت را اضافه نکنید." },
  { q: "آیا باید موقعیت مکانی گوشی را همیشه خاموش کنم؟", a: "نه، اما فقط به اپلیکیشن‌های ضروری (مثل نقشه) اجازه دهید. در تنظیمات گوشی، دسترسی موقعیت را برای هر اپ بررسی کنید." },
  { q: "مرورگر امن چیست؟", a: "مرورگرهایی مثل Firefox یا Brave که حریم خصوصی کاربر را جدی می‌گیرند و ردیاب‌ها را مسدود می‌کنند." },
  { q: "موتور جستجوی امن چیست؟", a: "موتورهایی مثل DuckDuckGo یا Startpage که جستجوهای شما را ذخیره نمی‌کنند و هویت شما را ردیابی نمی‌کنند." },
  { q: "چطور از DuckDuckGo استفاده کنم؟", a: "مستقیماً به duckduckgo.com بروید یا اپلیکیشن آن را نصب کنید. همچنین می‌توانید آن را به عنوان موتور جستجوی پیش‌فرض مرورگر خود تنظیم کنید." },
  { q: "وی‌پی‌ان (VPN) چیست؟", a: "وی‌پی‌ان اتصال امنی بین دستگاه شما و اینترنت ایجاد می‌کند و آدرس IP شما را پنهان می‌کند." },
  { q: "آیا همه VPNها امن هستند؟", a: "خیر! برخی VPNهای رایگان داده‌های شما را می‌فروشند. از سرویس‌های معتبر مثل ProtonVPN، Mullvad یا Windscribe استفاده کنید." },
  { q: "چطور ProtonVPN را نصب کنم؟", a: "اپلیکیشن ProtonVPN را از فروشگاه رسمی (Google Play یا App Store) دانلود کنید. حساب رایگان ایجاد کنید و وارد شوید." },
  { q: "آیا استفاده از VPN در افغانستان قانونی است؟", a: "قوانین ممکن است تغییر کند، اما هدف Seda محافظت از فعالان است. همیشه از VPNهایی استفاده کنید که بدون لاگ (بدون ثبت اطلاعات) کار می‌کنند." },
  { q: "چطور دستگاه اندروید خود را امن کنم؟", a: "رمز عبور قوی برای گوشی بگذارید، به‌روزرسانی‌ها را نصب کنید، فقط از فروشگاه رسمی اپ نصب کنید، و دسترسی‌های اپلیکیشن‌ها را بررسی کنید." },
  { q: "چطور دستگاه آیفون خود را امن کنم؟", a: "رمز عبور یا Face ID فعال کنید، iOS را به‌روز نگه دارید، و فقط از App Store اپلیکیشن نصب کنید." },
  { q: "آیا باید همیشه اپلیکیشن‌ها را به‌روز کنم؟", a: "بله! به‌روزرسانی‌ها اغلب شامل رفع آسیب‌پذیری‌های امنیتی هستند." },
  { q: "چطور اپلیکیشن‌های مخرب را تشخیص بدم؟", a: "به تعداد دانلود، نظرات کاربران، مجوزهای درخواستی (مثلاً یک ماشین‌حساب چرا به مخاطبین نیاز دارد؟) و توسعه‌دهنده توجه کنید." },
  { q: "اگر فکر می‌کنم گوشی‌ام هک شده، چه کنم؟", a: "اپلیکیشن‌های مشکوک را پاک کنید، رمز عبور تمام حساب‌ها را عوض کنید، و در صورت نیاز، گوشی را به تنظیمات کارخانه برگردانید." },
  { q: "چطور از حساب‌های خود در صورت گم شدن گوشی محافظت کنم؟", a: "در گوشی اندروید از 'Find My Device' و در آیفون از 'Find My iPhone' استفاده کنید تا دستگاه را قفل یا پاک کنید." },
  { q: "آیا می‌توانم بدون اینترنت از Seda استفاده کنم؟", a: "بله! تمام محتوای Seda به صورت آفلاین در دسترس است. نیازی به اینترنت برای استفاده از چت‌بات نیست." },
  { q: "آیا Seda اطلاعات من را ذخیره می‌کند؟", a: "خیر! Seda هیچ داده‌ای از شما جمع‌آوری نمی‌کند. همه چیز در دستگاه شما باقی می‌ماند." },
  { q: "چطور از اشتراک‌گذاری عکس‌های فرزندانم در شبکه‌های اجتماعی جلوگیری کنم؟", a: "بهتر است اصلاً عکس کودکان را آنلاین به اشتراک نگذارید. اگر ضروری است، فقط با افراد قابل اعتماد و از طریق پیام‌رسان‌های رمزنگاری‌شده ارسال کنید." },
  { q: "رمزنگاری end-to-end چیست؟", a: "یعنی فقط شما و گیرنده می‌توانید پیام را بخوانید. حتی شرکت ارائه‌دهنده (مثل واتساپ) نمی‌تواند محتوای پیام را ببیند." },
  { q: "کدام پیام‌رسان‌ها امن‌ترند؟", a: "سیگنال (Signal) امن‌ترین گزینه است. واتساپ نیز از رمزنگاری end-to-end استفاده می‌کند، اما متعلق به فیسبوک است." },
  { q: "چطور حساب سیگنال را ایجاد کنم؟", a: "اپلیکیشن Signal را نصب کنید، شماره تلفن خود را وارد کنید، و کد تأیید را دریافت کنید. هیچ اطلاعات اضافی نیاز نیست." },
  { q: "آیا می‌توانم در سیگنال ناشناس باشم؟", a: "تا حدی. شماره تلفن شما برای مخاطبین قابل مشاهده است، اما می‌توانید نام و عکس پروفایل را مخفی کنید." },
  { q: "چطور از اسکرین‌شات گرفتن در پیام‌ها جلوگیری کنم؟", a: "در تلگرام، پیام‌ها را در چت‌های 'مخفی' ارسال کنید. در سیگنال، از گزینه 'پیام‌های ناپدیدشونده' استفاده کنید." },
  { q: "چطور از حساب‌های خود در صورت فراموشی رمز عبور بازیابی کنم؟", a: "همیشه ایمیل بازیابی یا شماره تلفن را به‌روز نگه دارید. برای حساب‌های مهم، از کدهای بازیابی (recovery codes) استفاده کنید." },
  { q: "کدهای بازیابی 2FA چیستند؟", a: "کدهای یک‌بارمصرفی که هنگام فعال‌سازی 2FA دریافت می‌کنید و باید آن‌ها را در جای امنی ذخیره کنید. اگر دستگاهتان گم شد، با این کدها وارد می‌شوید." },
  { q: "چطور کدهای بازیابی را ذخیره کنم؟", a: "آن‌ها را روی کاغذ بنویسید و در جای امن فیزیکی نگه دارید. هرگز در فایل متنی یا ایمیل ذخیره نکنید." },
  { q: "آیا می‌توانم از ایمیل عمومی (مثل Gmail) برای فعالیت‌هایم استفاده کنم؟", a: "ترجیحاً خیر. برای فعالیت‌های حساس، از ایمیل‌های امن مثل ProtonMail یا Tutanota استفاده کنید." },
  { q: "چطور ProtonMail را نصب کنم؟", a: "به proton.me بروید یا اپلیکیشن ProtonMail را نصب کنید. حسابی با رمز عبور قوی ایجاد کنید." },
  { q: "چطور از ردیابی آنلاین جلوگیری کنم؟", a: "از مرورگرهای امن، مسدودکننده تبلیغات (مثل uBlock Origin)، و حالت ناشناس استفاده کنید." },
  { q: "حالت ناشناس مرورگر چه کمکی می‌کند؟", a: "کوکی‌ها و تاریخچه را پس از بستن پنجره پاک می‌کند، اما فعالیت شما را از ISP یا دولت پنهان نمی‌کند. برای آن نیاز به VPN دارید." },
  { q: "چطور از اشتراک‌گذاری اطلاعات شغلی در آنلاین جلوگیری کنم؟", a: "در پروفایل‌های عمومی، جزئیات شغلی خود را مخفی کنید. از ایمیل و شماره کاری جداگانه استفاده کنید." },
  { q: "چطور از تهدیدهای آنلاین گزارش دهم؟", a: "در افغانستان، می‌توانید از طریق شبکه‌های فعالان زن یا سازمان‌های حقوق بشری بین‌المللی گزارش دهید. همیشه شواهد (اسکرین‌شات) را ذخیره کنید." },
  { q: "چطور از ایمیل‌های اسپم جلوگیری کنم؟", a: "هرگز ایمیل خود را در سایت‌های ناشناس وارد نکنید. از فیلترهای اسپم استفاده کنید و روی لینک‌های ایمیل‌های ناشناس کلیک نکنید." },
  { q: "آیا می‌توانم از نام مستعار در آنلاین استفاده کنم؟", a: "بله! برای فعالیت‌های حساس، از نام مستعار و عکس پروفایل غیرقابل شناسایی استفاده کنید." },
  { q: "چطور از حساب‌های خود در برابر هک جلوگیری کنم؟", a: "2FA فعال کنید، رمز عبور قوی بسازید، اپلیکیشن‌ها را به‌روز نگه دارید، و فقط از دستگاه‌های شخصی استفاده کنید." },
  { q: "آیا استفاده از وای‌فای عمومی امن است؟", a: "خیر! در وای‌فای عمومی، از VPN استفاده کنید یا از داده موبایل خود استفاده کنید." },
  { q: "چطور از داده‌هایم در صورت دستگیری محافظت کنم؟", a: "از رمز عبور قوی برای گوشی استفاده کنید، اپلیکیشن‌های حساس را با رمز جداگانه قفل کنید، و داده‌های مهم را رمزنگاری کنید." },
  { q: "چطور اپلیکیشن‌ها را با رمز قفل کنم؟", a: "در اندروید، از 'App Lock' یا تنظیمات داخلی گوشی (مثل Secure Folder در سامسونگ) استفاده کنید." },
  { q: "چطور از فعالیت آنلاین خود برای دیگران پرده بزنم؟", a: "از نام مستعار، ایمیل جداگانه، و پروفایل‌های مجزا برای فعالیت‌های مختلف استفاده کنید." },
  { q: "چطور از کودکانم در فضای مجازی محافظت کنم؟", a: "با آن‌ها درباره خطرات آنلاین صحبت کنید، تنظیمات والدین را فعال کنید، و فعالیت آن‌ها را زیر نظر داشته باشید." },
  { q: "چطور از اپلیکیشن‌های ردیابی جلوگیری کنم؟", a: "در تنظیمات گوشی، دسترسی 'موقعیت مکانی'، 'مخاطبین' و 'دوربین' را برای اپلیکیشن‌های غیرضروری خاموش کنید." },
  { q: "چطور متوجه شوم که آیا اپلیکیشنی مرا ردیابی می‌کند؟", a: "اگر اپلیکیشنی مجوزهای زیادی درخواست کند (مثل یک بازی که به مخاطبین نیاز دارد)، مشکوک است. از اپلیکیشن‌های متن‌باز و معتبر استفاده کنید." },
  { q: "آیا می‌توانم از Seda به دوستانم معرفی کنم؟", a: "بله! Seda برای همه فعالان زن افغان طراحی شده و نیازی به ثبت‌نام ندارد." },
  { q: "چطور ویدیوهای آموزشی Seda را ببینم؟", a: "در بخش 'کتابخانه ویدیو' اپلیکیشن Seda، ویدیوهای آموزشی را به صورت آفلاین تماشا کنید." },
  { q: "آیا ویدیوهای Seda نیاز به اینترنت دارند؟", a: "خیر! پس از دانلود اولیه، همه ویدیوها به صورت آفلاین قابل دسترسی هستند." },
  { q: "چطور از اشتراک‌گذاری اطلاعات خانواده در آنلاین جلوگیری کنم؟", a: "اسم خانواده، محل سکونت، یا عکس خانواده را در پست‌های عمومی به اشتراک نگذارید." },
  { q: "چطور از تهدیدهای جنسی آنلاین جلوگیری کنم؟", a: "هرگز عکس یا اطلاعات شخصی را با افراد ناشناس به اشتراک نگذارید. در صورت تهدید، گزارش دهید و پلیس یا شبکه فعالان را مطلع کنید." },
  { q: "چطور از حساب‌های خود در برابر بازیابی توسط دیگران جلوگیری کنم؟", a: "اطلاعات بازیابی (مثل ایمیل یا شماره) را به‌روز و امن نگه دارید. از کدهای بازیابی استفاده کنید." },
  { q: "چطور از اپلیکیشن‌های مالی امن استفاده کنم؟", a: "فقط از اپلیکیشن‌های رسمی بانک‌ها استفاده کنید، 2FA فعال کنید، و هرگز رمز عبور را در دستگاه ذخیره نکنید." },
  { q: "آیا می‌توانم از Seda در کامپیوتر استفاده کنم؟", a: "در حال حاضر Seda فقط برای موبایل طراحی شده، اما ممکن است در آینده نسخه وب ارائه شود." },
  { q: "چطور از اپلیکیشن Seda پشتیبان‌گیری کنم؟", a: "Seda نیازی به پشتیبان‌گیری ندارد، چون داده‌ای ذخیره نمی‌کند. همه چیز آفلاین و موقتی است." },
  { q: "چطور با تیم Seda تماس بگیرم؟", a: "در حال حاضر امکان تماس مستقیم وجود ندارد، اما می‌توانید بازخورد خود را از طریق فرم داخل اپلیکیشن ارسال کنید." },
  { q: "آیا Seda برای مردان هم قابل استفاده است؟", a: "هدف اصلی Seda حمایت از زنان فعال افغان است، اما هر کسی می‌تواند از آموزش‌های آن استفاده کند." },
  { q: "چطور از اپلیکیشن‌های امنیتی دیگر مطلع شوم؟", a: "در بخش 'منابع' اپلیکیشن Seda، لیستی از ابزارهای معتبر ارائه شده است." },
  { q: "چطور از امنیت ایمیل خود مطمئن شوم؟", a: "2FA فعال کنید، رمز عبور قوی بسازید، و از ایمیل‌های امن مثل ProtonMail استفاده کنید." },
  { q: "چطور از امنیت پیام‌رسان‌هایم مطمئن شوم؟", a: "از سیگنال یا تلگرام (در چت‌های مخفی) استفاده کنید، و همیشه به‌روز باشید." },
  { q: "آیا می‌توانم از Seda بدون نصب استفاده کنم؟", a: "خیر، باید اپلیکیشن را نصب کنید تا از محتوای آفلاین آن استفاده کنید." }
];
// نمایش پیام ربات
function showBotMessage(text) {
  const messageDiv = document.createElement('div');
  messageDiv.className = 'message bot';
  messageDiv.innerHTML = `
    <div class="avatar bot"><i class="fas fa-robot"></i></div>
    <div class="message-content">${text}</div>
  `;
  chatbotMessages.appendChild(messageDiv);
  chatbotMessages.scrollTop = chatbotMessages.scrollHeight; // اسکرول خودکار
}

// نمایش پیام کاربر
function showUserMessage(text) {
  const messageDiv = document.createElement('div');
  messageDiv.className = 'message user';
  messageDiv.innerHTML = `
    <div class="avatar user"><i class="fas fa-user"></i></div>
    <div class="message-content">${text}</div>
  `;
  chatbotMessages.appendChild(messageDiv);
  chatbotMessages.scrollTop = chatbotMessages.scrollHeight; // اسکرول خودکار
}

// دریافت جواب
function getAnswer(question) {
  const lowerQ = question.trim().toLowerCase();
  for (let item of knowledgeBase) {
    if (lowerQ.includes(item.q.toLowerCase().replace(/[؟?]/g, ''))) {
      return item.a;
    }
  }

  // پاسخ‌های عمومی
  if (lowerQ.includes('2fa') || lowerQ.includes('دو عاملی') || lowerQ.includes('احراز هویت')) {
    return "برای فعال‌سازی احراز هویت دو عاملی، به تنظیمات امنیتی حساب خود بروید.";
  }
  if (lowerQ.includes('رمز') || lowerQ.includes('پسورد')) {
    return "رمز عبور قوی بسازید: حداقل ۱۲ کاراکتر، ترکیبی از حروف، اعداد و نمادها.";
  }
  if (lowerQ.includes('فیش') || lowerQ.includes('phish') || lowerQ.includes('کلاهبردار')) {
    return "پیام‌های فیشینگ را شناسایی کنید و روی لینک‌های ناشناخته کلیک نکنید.";
  }
  if (lowerQ.includes('حریم خصوصی') || lowerQ.includes('خصوصی')) {
    return "تنظیمات حریم خصوصی شبکه‌های اجتماعی خود را بررسی کنید.";
  }
  return "متاسفانه پاسخ این سوال را نمی‌دانم. سوال دیگری بپرسید.";
}

// ارسال پیام
function handleSendMessage() {
  const text = chatbotInput.value.trim();
  if (!text) return;
  showUserMessage(text);
  chatbotInput.value = '';
  const answer = getAnswer(text);
  setTimeout(() => showBotMessage(answer), 500);
}

// Event Listeners
chatbotSend.addEventListener('click', handleSendMessage);
chatbotInput.addEventListener('keypress', e => { if (e.key === 'Enter') handleSendMessage(); });
chatbotClose.addEventListener('click', () => { chatbotWindow.style.display = 'none'; });
chatbotButton.addEventListener('click', () => {
  chatbotWindow.style.display = 'block';
  showBotMessage("سلام! من چت بات سِدا هستم. می‌توانم به شما در امنیت دیجیتال کمک کنم 😊");
});
